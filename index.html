<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Delaware City School District Status</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
    font-family: Arial, sans-serif;
    background: #1e1e1e; /* Dark Gray */
    color: #f0f0f0; /* Off-white text */
    padding: 20px;
    text-align: center;
}
#status {
    font-size: 40px;
    font-weight: bold;
    padding: 25px;
    border-radius: 15px;
    display: inline-block;
    margin-top: 20px;
    min-width: 250px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.5);
    transition: background-color 0.3s ease;
}
.open { background: #2e7d32; color: white; border: 2px solid #1b5e20; }
.delay { background: #ef6c00; color: white; border: 2px solid #e65100; }
.closed { background: #c62828; color: white; border: 2px solid #b71c1c; }
.unknown { background: #455a64; color: white; border: 2px solid #263238; }

h1 { margin-bottom: 5px; color: #ffffff; }
h3 { margin-top: 5px; color: #b0bec5; font-weight: normal; }
p { color: #90a4ae; font-size: 14px; margin-top: 30px; }
</style>
</head>
<body>

<h1>Delaware City School District</h1>
<h3>Real-Time Status</h3>

<div id="status" class="unknown">Loading...</div>

<p>Auto-updates every 30 seconds.</p>

<script>
// THIS IS YOUR RENDER PROXY URL
const API = "https://delaware-status-proxy.onrender.com/status";

async function loadStatus() {
    const box = document.getElementById("status");
    
    // Only show "Checking..." on the very first load to avoid flickering
    if (box.textContent === "Loading...") {
        box.textContent = "Checking...";
    }

    try {
        const response = await fetch(API);
        const data = await response.json();

        // The proxy returns { status: "OPEN" } directly. 
        // We do not need to search for district names here anymore.
        const status = data.status.toUpperCase();

        if (status === "OPEN") {
            box.textContent = "OPEN";
            box.className = "open";
        } else if (status.includes("DELAY")) {
            box.textContent = "DELAYED";
            box.className = "delay";
        } else if (status === "CLOSED") {
            box.textContent = "CLOSED";
            box.className = "closed";
        } else {
            box.textContent = "OFFLINE / UNKNOWN";
            box.className = "unknown";
        }

    } catch (err) {
        console.error(err);
        box.textContent = "Connection Error";
        box.className = "unknown";
    }
}

// Run immediately + refresh every 30s
loadStatus();
setInterval(loadStatus, 30000);
</script>

</body>
</html>
